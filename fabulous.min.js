!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.fabulous=e()}(this,function(){"use strict";function t(t,e){this._root=t,this._depth=e,this._enter=this._update=this._exit=null}function e(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function n(t,n,r){var i=e(t),s=i.CustomEvent;s?s=new s(n,r):(s=i.document.createEvent("Event"),r?(s.initEvent(n,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(n,!1,!1)),t.dispatchEvent(s)}function r(t,e){function r(){return n(this,t,e)}function i(){return n(this,t,e.apply(this,arguments))}return this.each("function"==typeof e?i:r)}function i(){}function s(t){return t.replace(te,"\\$&")}function o(t){return function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t(e)}}function a(t,e,n){return function(r){for(var i=e.length,s=ee;--i>=0;)n[i<<1]=e[i].__data__;ee=r;try{t.apply(e[0],n)}finally{ee=s}}}function u(t,e,n){function r(){for(var r=g,i=arguments.length>>1,s=new Array(i);--i>=0;)r=r[arguments[(i<<1)+1]],s[i]=i?r._parent:r;var h=a(e,s,arguments);l&&(h=o(h)),u.call(this),this.addEventListener(t,this[f]=h,h._capture=n),h._listener=e}function u(){var e=this[f];e&&(this.removeEventListener(t,e,e._capture),delete this[f])}function h(){var e,n=new RegExp("^__on([^.]+)"+s(t)+"$");for(var r in this)if(e=r.match(n)){var i=this[r];this.removeEventListener(e[1],i,i._capture),delete this[r]}}var l,c=arguments.length,f="__on"+t,g=this._root;return 2>c?(c=this.node()[f])&&c._listener:(3>c&&(n=!1),(c=t.indexOf("."))>0&&(t=t.slice(0,c)),(l=ne.has(t))&&(t=ne.get(t)),this.each(e?c?r:i:c?u:h))}function h(t){return arguments.length?this.property("__data__",t):this.node().__data__}function l(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})}function c(t){return function(){return this.querySelector(t)}}function f(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.slice(0,e),t=t.slice(e+1)),ie.has(n)?{space:ie.get(n),local:t}:t}function g(t){function e(){var e=this.ownerDocument,n=this.namespaceURI;return n?e.createElementNS(n,t):e.createElement(t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return t=f(t),t.local?n:e}function p(t,e){function n(){return this.appendChild(t.apply(this,arguments))}function r(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)}return"function"!=typeof t&&(t=g(t)),this.select(arguments.length<2?n:("function"!=typeof e&&(e=c(e)),r))}function d(t){function e(){this.innerHTML=t}function n(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}return arguments.length?(null==t&&(t=""),this.each("function"==typeof t?n:e)):this.node().innerHTML}function m(t){function e(){this.textContent=t}function n(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}return arguments.length?(null==t&&(t=""),this.each("function"==typeof t?n:e)):this.node().textContent}function v(t){return t.trim().replace(/\s+/g," ")}function y(t){var e;return function(n,r){if(i=n.classList)return r?i.add(t):i.remove(t);e||(e=new RegExp("(?:^|\\s+)"+s(t)+"(?:\\s+|$)","g"));var i=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(i)||n.setAttribute("class",v(i+" "+t))):n.setAttribute("class",v(i.replace(e," ")))}}function _(t,e){function n(){for(var n=-1;++n<i;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<i;)t[n](this,r)}t=(t+"").trim().split(/^|\s+/);var i=t.length;if(arguments.length<2){var s=this.node(),o=-1;if(e=s.classList){for(;++o<i;)if(!e.contains(t[o]))return!1}else for(e=s.getAttribute("class");++o<i;)if(!classedRe(t[o]).test(e))return!1;return!0}return t=t.map(y),this.each("function"==typeof e?r:n)}function w(t,e){function n(){delete this[t]}function r(){this[t]=e}function i(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return arguments.length<2?this.node()[t]:this.each(null==e?n:"function"==typeof e?i:r)}function b(t,n,r){function i(){this.style.removeProperty(t)}function s(){this.style.setProperty(t,n,r)}function o(){var e=n.apply(this,arguments);null==e?this.style.removeProperty(t):this.style.setProperty(t,e,r)}var a=arguments.length;return 2>a?e(a=this.node()).getComputedStyle(a,null).getPropertyValue(t):(3>a&&(r=""),this.each(null==n?i:"function"==typeof n?o:s))}function M(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,e)}function s(){this.setAttributeNS(t.space,t.local,e)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}if(t=f(t),arguments.length<2){var u=this.node();return t.local?u.getAttributeNS(t.space,t.local):u.getAttribute(t)}return this.each(null==e?t.local?r:n:"function"==typeof e?t.local?a:o:t.local?s:i)}function x(t){function e(n,i){var s,o=-1,a=n.length;if(--i)for(var u=2*i,h=u+1;++o<a;)(s=n[o])&&(r[u]=s._parent.__data__,r[h]=o,e(s,i));else for(;++o<a;)(s=n[o])&&(r[0]=s.__data__,r[1]=o,t.apply(s,r))}var n=this._depth,r=new Array(n);return e(this._root,n),this}function k(){return!this.node()}function N(){var t=0;return this.each(function(){++t}),t}function A(t,e){var n,r=-1,i=t.length;if(--e){for(;++r<i;)if((n=t[r])&&(n=A(n,e)))return n}else for(;++r<i;)if(n=t[r])return n}function S(){return A(this._root,this._depth)}function E(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function q(){var t=arguments[0];return t.apply(arguments[0]=this,arguments),this}function C(t,e){var n,r=-1,i=t.length;if(--e)for(;++r<i;)(n=t[r])&&(t[r]=C(n,e));else if(!Array.isArray(t)){for(var s=new Array(i);++r<i;)s[r]=t[r];s._parent=t._parent,t=s}return t}function j(t){return t._root=C(t._root,t._depth)}function $(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function z(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}function n(t,r){if(--r)for(var i,s=-1,o=t.length;++s<o;)(i=t[s])&&n(i,r);else t.sort(e)}return t||(t=$),n(j(this),this._depth),this.order()}function P(t,e){var n,r,i=t.length;if(--e)for(;--i>=0;)(n=t[i])&&P(n,e);else for(r=t[--i];--i>=0;)(n=t[i])&&(r&&r!==n.nextSibling&&r.parentNode.insertBefore(n,r),r=n)}function L(){return P(this._root,this._depth),this}function D(t,e){var n,r=-1,i=t.length,s=new Array(i);if(--e)for(;++r<i;)(n=t[r])&&(s[r]=D(n,e));return s._parent=t._parent,s}function I(e){return new t(D(j(e),e._depth),e._depth)}function R(){return this._exit||(this._exit=I(this))}function F(){return this._enter||(this._enter=I(this),this._enter._update=this),this._enter}function T(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function O(t){return function(){return t}}function B(t,e){function n(e,r,i,s){var o,a,l=-1;if(s--){var c=2*s,f=c+1;for(o=e.length;++l<o;)(a=e[l])&&(u[c]=a._parent.__data__,u[f]=l,n(a,r[l],i[l],s))}else{var g,p=0;for(h(e,r,i,t.apply(e._parent,u)),o=e.length;++l<o;)if(g=r[l]){for(l>=p&&(p=l+1);!(a=e[p])&&++p<o;);g._next=a||null}}}function r(t,e,n,r){var i,s=0,o=t.length,a=r.length,u=Math.min(o,a);for(e.length=0,e.length=a,n.length=0,n.length=o;u>s;++s)(i=t[s])?i.__data__=r[s]:e[s]=new T(t._parent,r[s]);for(;a>s;++s)e[s]=new T(t._parent,r[s]);for(;o>s;++s)(i=t[s])&&(n[s]=t[s]);t.length=a}function i(t,n,r,i){var s,o,a,h=i.length,l=t.length,c=new Map,f=new Array(2).concat(u),g=new Array(l);for(n.length=0,n.length=h,r.length=0,r.length=l,s=0;l>s;++s)(o=t[s])&&(f[0]=o.__data__,f[1]=s,g[s]=a=e.apply(o,f),c.has(a)?r[s]=o:c.set(a,o));for(t.length=0,t.length=h,s=0;h>s;++s)f[0]=i[s],f[1]=s,a=e.apply(t._parent,f),(o=c.get(a))?o!==!0&&(t[s]=o,o.__data__=i[s]):n[s]=new T(t._parent,i[s]),c.set(a,!0);for(s=0;l>s;++s)(o=c.get(g[s]))!==!0&&(r[s]=o)}if(!t){var s=new Array(this.size()),o=-1;return this.each(function(t){s[++o]=t}),s}var a=this._depth-1,u=new Array(2*a),h=e?i:r;return"function"!=typeof t&&(t=O(t)),n(this._root,this.enter()._root,this.exit()._root,a),this}function U(e){function n(t,r){var s,o,a=-1,u=t.length;if(--r){var h=2*r,l=h+1;for(o=new Array(u);++a<u;)(s=t[a])&&(i[h]=s._parent.__data__,i[l]=a,o[a]=n(s,r))}else for(o=[];++a<u;)(s=t[a])&&(i[0]=s.__data__,i[1]=a,e.apply(s,i)&&o.push(s));return o._parent=t._parent,o}var r=this._depth,i=new Array(2*r);return"function"!=typeof e&&(e=se(e)),new t(n(this._root,r),r)}function X(t){return function(){return this.querySelectorAll(t)}}function H(e){function n(t,r){var s,o,a=-1,u=t.length,h=new Array(u);if(--r)for(var l=2*r,c=l+1;++a<u;)(s=t[a])&&(i[l]=s._parent.__data__,i[c]=a,h[a]=n(s,r));else for(;++a<u;)(s=t[a])&&(i[0]=s.__data__,i[1]=a,h[a]=o=e.apply(s,i),o._parent=s);return h._parent=t._parent,h}var r=this._depth,i=new Array(2*r);return"function"!=typeof e&&(e=X(e)),new t(n(this._root,r),r+1)}function V(e){function n(t,r,s){var o,a,u=-1,h=t.length,l=new Array(h);if(--s)for(var c=2*s,f=c+1;++u<h;)(o=t[u])&&(i[c]=o._parent.__data__,i[f]=u,l[u]=n(o,r&&r[u],s));else for(;++u<h;)(o=t[u])&&(i[0]=o.__data__,i[1]=u,(a=e.apply(o,i))&&("__data__"in o&&(a.__data__=o.__data__),r&&(r[u]=a,delete t[u]),l[u]=a));return l._parent=t._parent,l}var r=this._depth,i=new Array(2*r);return"function"!=typeof e&&(e=c(e)),new t(n(this._root,this._update&&this._update._root,r),r)}function G(){return new t([document.documentElement],1)}function Y(e){return new t(["string"==typeof e?document.querySelector(e):e],1)}function Z(e){return new t("string"==typeof e?document.querySelectorAll(e):e,1)}function J(t,e,n){this.h=+t,this.s=Math.max(0,Math.min(1,+e)),this.l=Math.max(0,Math.min(1,+n))}function K(){}function Q(t,e,n){this.r=Math.max(0,Math.min(255,Math.round(t))),this.g=Math.max(0,Math.min(255,Math.round(e))),this.b=Math.max(0,Math.min(255,Math.round(n)))}function W(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),isNaN(n)&&(n=0),"#"+(16>t?"0"+t.toString(16):t.toString(16))+(16>e?"0"+e.toString(16):e.toString(16))+(16>n?"0"+n.toString(16):n.toString(16))}function tt(t,e,n){return 255*(60>t?e+(n-e)*t/60:180>t?n:240>t?e+(n-e)*(240-t)/60:e)}function et(t,e,n){return 1===arguments.length&&(t instanceof K||(t=rt(t)),t?(t=t.rgb(),n=t.b,e=t.g,t=t.r):t=e=n=NaN),new Q(t,e,n)}function nt(t){return et(t>>16&255,t>>8&255,255&t)}function rt(t){var e;return t=(t+"").trim().toLowerCase(),(e=ye.exec(t))?(e=parseInt(e[1],16),et(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e)):(e=ve.exec(t))?nt(parseInt(e[1],16)):(e=me.exec(t))?et(e[1],e[2],e[3]):(e=de.exec(t))?et(2.55*e[1],2.55*e[2],2.55*e[3]):(e=pe.exec(t))?it(e[1],.01*e[2],.01*e[3]):ge.has(t)?nt(ge.get(t)):null}function it(t,e,n){if(1===arguments.length)if(t instanceof J)n=t.l,e=t.s,t=t.h;else if(t instanceof K||(t=rt(t)),t){if(t instanceof J)return t;t=t.rgb();var r=t.r/255,i=t.g/255,s=t.b/255,o=Math.min(r,i,s),a=Math.max(r,i,s),u=a-o;n=(a+o)/2,u?(e=.5>n?u/(a+o):u/(2-a-o),t=r===a?(i-s)/u+6*(s>i):i===a?(s-r)/u+2:(r-i)/u+4,t*=60):(t=NaN,e=n>0&&1>n?0:t)}else t=e=n=NaN;return new J(t,e,n)}function st(t,e){return t=+t,e-=t,function(n){return t+e*n}}function ot(t,e){var n,r={},i={};for(n in t)n in e?r[n]=ft(t[n],e[n]):i[n]=t[n];for(n in e)n in t||(i[n]=e[n]);return function(t){for(n in r)i[n]=r[n](t);return i}}function at(t,e){var n,r=[],i=[],s=t.length,o=e.length,a=Math.min(t.length,e.length);for(n=0;a>n;++n)r.push(ft(t[n],e[n]));for(;s>n;++n)i[n]=t[n];for(;o>n;++n)i[n]=e[n];return function(t){for(n=0;a>n;++n)i[n]=r[n](t);return i}}function ut(t,e){t=et(t),e=et(e);var n=t.r,r=t.g,i=t.b,s=e.r-n,o=e.g-r,a=e.b-i;return function(t){return W(Math.round(n+s*t),Math.round(r+o*t),Math.round(i+a*t))}}function ht(t){return function(){return t}}function lt(t){return function(e){return t(e)+""}}function ct(t,e){var n,r,i,s=_e.lastIndex=we.lastIndex=0,o=-1,a=[],u=[];for(t+="",e+="";(n=_e.exec(t))&&(r=we.exec(e));)(i=r.index)>s&&(i=e.slice(s,i),a[o]?a[o]+=i:a[++o]=i),(n=n[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,u.push({i:o,x:st(n,r)})),s=we.lastIndex;return s<e.length&&(i=e.slice(s),a[o]?a[o]+=i:a[++o]=i),a.length<2?u[0]?lt(u[0].x):ht(e):(e=u.length,function(t){for(var n,r=0;e>r;++r)a[(n=u[r]).i]=n.x(t);return a.join("")})}function ft(t,e){for(var n,r=be.length;--r>=0&&!(n=be[r](t,e)););return n}function gt(t,e){null==e&&(e=10);var n=t[0],r=t[t.length-1];n>r&&(o=r,r=n,n=o);var i=r-n,s=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=i/e/s;return o>=ke?s*=10:o>=xe?s*=5:o>=Me&&(s*=2),[Math.ceil(n/s)*s,Math.floor(r/s)*s+s/2,s]}function pt(t,e){if(t=t.slice(),!e)return t;var n,r=0,i=t.length-1,s=t[r],o=t[i];return s>o&&(n=r,r=i,i=n,n=s,s=o,o=n),t[r]=Math.floor(s/e)*e,t[i]=Math.ceil(o/e)*e,t}function dt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function mt(t){return t=dt(Math.abs(t)),t?t[1]:NaN}function vt(t,e){var n=dt(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(fe=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+dt(t,e+s-1)[0]}function yt(t,e){var n=dt(t,e);if(!n)return t+"";var r=n[0],i=n[1];return 0>i?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}function _t(t,e){t=t.toPrecision(e);t:for(var n,r=t.length,i=1,s=-1;r>i;++i)switch(t[i]){case".":s=n=i;break;case"0":0===s&&(s=i),n=i;break;case"e":break t;default:s>0&&(s=0)}return s>0?t.slice(0,s)+t.slice(n+1):t}function wt(t){if(!(e=Se.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",s=e[4]||"",o=!!e[5],a=e[6]&&+e[6],u=!!e[7],h=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(u=!0,l="g"):Ae[l]||(l=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=s,this.zero=o,this.width=a,this.comma=u,this.precision=h,this.type=l}function bt(t){return new wt(t)}function Mt(t){return t}function xt(t,e){return function(n,r){for(var i=n.length,s=[],o=0,a=t[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function kt(t){function e(t){t=bt(t);var e=t.fill,n=t.align,o=t.sign,a=t.symbol,u=t.zero,h=t.width,l=t.comma,c=t.precision,f=t.type,g="$"===a?i[0]:"#"===a&&/[boxX]/.test(f)?"0"+f.toLowerCase():"",p="$"===a?i[1]:/[%p]/.test(f)?"%":"",d=Ae[f],m=!f||/[defgprs%]/.test(f);return c=null==c?f?6:12:/[gprs]/.test(f)?Math.max(1,Math.min(21,c)):Math.max(0,Math.min(20,c)),function(t){var i=g,a=p;if("c"===f)a=d(t)+a,t="";else{t=+t;var v=(0>t||0>1/t)&&(t*=-1,!0);if(t=d(t,c),i=(v?"("===o?o:"-":"-"===o||"("===o?"":o)+i,a=a+("s"===f?Ne[8+fe/3]:"")+(v&&"("===o?")":""),m)for(var y,_=-1,w=t.length;++_<w;)if(y=t.charCodeAt(_),48>y||y>57){a=(46===y?s+t.slice(_+1):t.slice(_))+a,t=t.slice(0,_);break}}l&&!u&&(t=r(t,1/0));var b=i.length+t.length+a.length,M=h>b?new Array(h-b+1).join(e):"";switch(l&&u&&(t=r(M+t,M.length?h-a.length:1/0),M=""),n){case"<":return i+t+a+M;case"=":return i+M+t+a;case"^":return M.slice(0,b=M.length>>1)+i+t+a+M.slice(b)}return M+i+t+a}}function n(t,n){var r=e((t=bt(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(mt(n)/3))),s=Math.pow(10,-i),o=Ne[8+i/3];return function(t){return r(s*t)+o}}var r=t.grouping&&t.thousands?xt(t.grouping,t.thousands):Mt,i=t.currency,s=t.decimal;return{format:e,formatPrefix:n}}function Nt(t){return Math.max(0,-mt(Math.abs(t)))}function At(t,e){return Math.max(0,mt(Math.abs(e))-mt(Math.abs(t)))+1}function St(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mt(e)/3)))-mt(Math.abs(t)))}function Et(t,e,n){var r=gt(t,e);if(null==n)n=",."+Nt(r[2])+"f";else switch(n=bt(n),n.type){case"s":var i=Math.max(Math.abs(r[0]),Math.abs(r[1]));return null==n.precision&&(n.precision=St(r[2],i)),Ce(n,i);case"":case"e":case"g":case"p":case"r":null==n.precision&&(n.precision=At(r[2],Math.max(Math.abs(r[0]),Math.abs(r[1])))-("e"===n.type));break;case"f":case"%":null==n.precision&&(n.precision=Nt(r[2])-2*("%"===n.type))}return qe(n)}function qt(t){for(var e=1;t*e%1;)e*=10;return e}function Ct(t,e,n){(i=arguments.length)<3&&(n=1,2>i&&(e=t,t=0));var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),s=qt(Math.abs(n)),o=new Array(i);for(t*=s,n*=s;++r<i;)o[r]=(t+r*n)/s;return o}function jt(t,e){return Ct.apply(null,gt(t,e))}function $t(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}}function zt(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Pt(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Lt(t,e,n,r){var i=n(t[0],t[1]),s=r(e[0],e[1]);return function(t){return s(i(t))}}function Dt(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function It(t){return function(e,n){return Dt(t(e),n)}}function Rt(t){return 1===t.length&&(t=It(t)),{left:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);i>r;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);i>r;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Ft(t,e,n,r){var i=Math.min(t.length,e.length)-1,s=new Array(i),o=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)s[a]=n(t[a],t[a+1]),o[a]=r(e[a],e[a+1]);return function(e){var n=ze(t,e,1,i)-1;return o[n](s[n](e))}}function Tt(t,e,n,r){function i(){var i=Math.min(t.length,e.length)>2?Ft:Lt,u=r?Pt:zt;return o=i(t,e,u,n),a=i(e,t,u,st),s}function s(t){return o(t)}var o,a;return s.invert=function(t){return a(t)},s.domain=function(e){return arguments.length?(t=e.map(Number),i()):t.slice()},s.range=function(t){return arguments.length?(e=t.slice(),i()):e.slice()},s.rangeRound=function(t){return s.range(t).interpolate($t)},s.clamp=function(t){return arguments.length?(r=!!t,i()):r},s.interpolate=function(t){return arguments.length?(n=t,i()):n},s.ticks=function(e){return jt(t,e)},s.tickFormat=function(e,n){return Et(t,e,n)},s.nice=function(e){return t=pt(t,gt(t,e)[2]),i()},s.copy=function(){return Tt(t,e,n,r)},i()}function Ot(){return Tt([0,1],[0,1],ft,!1)}function Bt(t,e,n){this.h=+t,this.c=+e,this.l=+n}function Ut(t,e,n){this.l=+t,this.a=+e,this.b=+n}function Xt(t){return 255*(.0031308>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ht(t){return t>Re?t*t*t:Fe*(t-Ie)}function Vt(t){return t>Ue?Math.pow(t,1/3):t/Fe+Ie}function Gt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Yt(t,e,n){if(1===arguments.length)if(t instanceof Ut)n=t.b,e=t.a,t=t.l;else if(t instanceof Bt){var r=t.h*Xe;n=Math.sin(r)*t.c,e=Math.cos(r)*t.c,t=t.l}else{t instanceof Q||(t=et(t));var i=Gt(t.r),s=Gt(t.g),n=Gt(t.b),o=Vt((.4124564*i+.3575761*s+.1804375*n)/Oe),a=Vt((.2126729*i+.7151522*s+.072175*n)/Be),u=Vt((.0193339*i+.119192*s+.9503041*n)/Te);n=200*(a-u),e=500*(o-a),t=116*a-16}return new Ut(t,e,n)}function Zt(t,e,n){return 1===arguments.length&&(t instanceof Bt?(n=t.l,e=t.c,t=t.h):(t instanceof Ut||(t=Yt(t)),n=t.l,e=Math.sqrt(t.a*t.a+t.b*t.b),t=Math.atan2(t.b,t.a)*He,0>t&&(t+=360))),new Bt(t,e,n)}function Jt(t,e,n){this.h=+t,this.s=+e,this.l=+n}function Kt(t,e,n){if(1===arguments.length)if(t instanceof Jt)n=t.l,e=t.s,t=t.h;else{t instanceof Q||(t=et(t));var r=t.r/255,i=t.g/255,s=t.b/255;n=(en*s+tn*r-We*i)/(en+tn-We);var o=s-n,a=(Ge*(i-n)-Ze*o)/Ye,u=Math.pow(n,Qe);e=Math.sqrt(a*a+o*o)/(Ge*u*(1-u)),t=e?Math.atan2(a,o)*He-120:NaN,0>t&&(t+=360)}return new Jt(t,e,n)}function Qt(){function t(t){function g(t,e){var n=Ot().domain([0,t]).range([0,360]),r=Ot().domain([0,1]).range([0,2])(e);return function(t){return Kt(n(t),r,.5)}}function p(t,e){var n=Ot().domain([0,t]).range([0,360]),r=Ot().domain([0,1]).range([0,100])(e);return function(t){return Zt(n(t),r,75)}}function d(t,e){var n=Ot().domain([0,t]).range([0,360]),r=Ot().domain([0,1]).range([0,1])(e);return function(t){return it(n(t),r,.5)}}function m(t){var e=["#E40303","#FF8C00","#FFED00","#008026","#004DFF","#750787"].map(function(e){var n=it(e);return n.s=t,n});return function(t){return e[t]}}function v(t,e){return t.unshift.apply(t,t.splice(e,t.length)),t}function y(t){console.log("%c       "+t+"      ","background: "+t+"; color: "+t+";")}function _(t,e,n,r,i,s){function o(t,e,n){var r=h(t);return n&&r.push("text-shadow: 0 0 40px "+t),"."+e+"::selection { "+r.join("; ")+" }"}function a(t,e,n){var r=h(t);return n&&r.push("text-shadow: 0 0 5px "+t),"."+e+"::-moz-selection { "+r.join("; ")+" }"}function u(t,e,n){var r=h(t);return n&&r.push("text-shadow: 0 0 40px "+t),"."+e+" { "+r.join("; ")+" }"}function h(t){return["background-color: transparent","color: "+t]}var l=[];return t.forEach(function(t,n){var h=r+n.toString();i&&(l.push(o(t,h,e)),l.push(a(t,h,e))),s&&l.push(u(t,h,e))}),n&&(l.push("::selection { background-color: transparent; }"),l.push("::-moz-selection { background-color: transparent; }")),l.join("\n")}function w(t){var e=[],n=Z(t);return n.each(function(){e.push(this),Y(this).selectAll("*").each(function(){e.push(this)})}),e}if(void 0!==Wt&&Wt++,!l&&!c)return void console.log("Neither .selection nor .text are set! Nothing for me to do.");s?i=Math.floor(Math.random()*e):i%=e;var b;"cubehelix"===n?b=g(e,r):"hcl"===n?b=p(e,r):"hsl"===n?b=d(e,r):"pride"===n?(b=m(r),e=6):(console.log("Style "+n+' not found. Defaulting to "hcl"'),b=p(e,r));var M=v(Ct(e).map(b),i);f&&(console.log("Style: ",n),console.log("Cycle: ",e),console.log("Rotation: ",i),M.forEach(y));var x="fabulous-"+Wt+"-";Y("body").append("style")["class"](a,!0).html(_(M,o,u,x,l,c));var k=w(t);if(h){var N=w(h);k=k.filter(function(t){return-1===N.indexOf(t)})}Z(k).filter(function(){var t=0===this.childElementCount||Array.prototype.slice.call(this.childNodes).some(function(t){return t.nodeType===Node.TEXT_NODE});return t}).each(function(t,n){var r=x+(n%e).toString();Y(this)["class"](r,!0)}).size()}console.log("init stuff");var e=30,n="hcl",r=.6,i=0,s=!1,o=!0,a="fabulous-styles",u=!0,h=null,l=!0,c=!1,f=!0;return t.style=function(e){return arguments.length?(n=e,t):n},t.cycle=function(n){return arguments.length?(e=n,t):e},t.intensity=function(e){return arguments.length?(r=e,t):r},t.rotation=function(e){return arguments.length?(i=e,t):i},t.randomRotation=function(e){return arguments.length?(s=e,t):s},t.glow=function(e){return arguments.length?(o=e,t):o},t.styleTagClass=function(e){return arguments.length?(a=e,t):a},t.disableOtherSelectionStyles=function(e){return arguments.length?(u=e,t):u},t.exclude=function(e){return arguments.length?(h=e,t):h},t.selection=function(e){return arguments.length?(l=e,t):l},t.text=function(e){return arguments.length?(c=e,t):c},t.preview=function(e){return arguments.length?(f=e,t):f},t}var Wt=0,te=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ee=null,ne=new Map;if("undefined"!=typeof document){var re=document.documentElement;"onmouseenter"in re||ne.set("mouseenter","mouseover").set("mouseleave","mouseout")}var ie=(new Map).set("svg","http://www.w3.org/2000/svg").set("xhtml","http://www.w3.org/1999/xhtml").set("xlink","http://www.w3.org/1999/xlink").set("xml","http://www.w3.org/XML/1998/namespace").set("xmlns","http://www.w3.org/2000/xmlns/");T.prototype={appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e||this._next)}};var se=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var oe=document.documentElement;if(!oe.matches){var ae=oe.webkitMatchesSelector||oe.msMatchesSelector||oe.mozMatchesSelector||oe.oMatchesSelector;se=function(t){return function(){return ae.call(this,t)}}}}t.prototype=G.prototype={select:V,selectAll:H,filter:U,data:B,enter:F,exit:R,order:L,sort:z,call:q,nodes:E,node:S,size:N,empty:k,each:x,attr:M,style:b,property:w,"class":_,classed:_,text:m,html:d,append:p,insert:p,remove:l,datum:h,event:u,on:u,dispatch:r},K.prototype={toString:function(){return this.rgb()+""}};var ue=J.prototype=new K,he=.7,le=Q.prototype=new K;le.brighter=function(t){return t=null==t?ce:Math.pow(ce,t),new Q(this.r*t,this.g*t,this.b*t)},le.rgb=function(){return this},le.toString=function(){return W(this.r,this.g,this.b)},le.darker=function(t){return t=null==t?he:Math.pow(he,t),new Q(this.r*t,this.g*t,this.b*t)};var ce=1/he;ue.brighter=function(t){return t=null==t?ce:Math.pow(ce,t),new J(this.h,this.s,this.l*t)},ue.darker=function(t){return t=null==t?he:Math.pow(he,t),new J(this.h,this.s,this.l*t)},ue.rgb=function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=.5>=n?n*(1+e):n+e-n*e,i=2*n-r;return new Q(tt(t>=240?t-240:t+120,i,r),tt(t,i,r),tt(120>t?t+240:t-120,i,r))};var fe,ge=(new Map).set("aliceblue",15792383).set("antiquewhite",16444375).set("aqua",65535).set("aquamarine",8388564).set("azure",15794175).set("beige",16119260).set("bisque",16770244).set("black",0).set("blanchedalmond",16772045).set("blue",255).set("blueviolet",9055202).set("brown",10824234).set("burlywood",14596231).set("cadetblue",6266528).set("chartreuse",8388352).set("chocolate",13789470).set("coral",16744272).set("cornflowerblue",6591981).set("cornsilk",16775388).set("crimson",14423100).set("cyan",65535).set("darkblue",139).set("darkcyan",35723).set("darkgoldenrod",12092939).set("darkgray",11119017).set("darkgreen",25600).set("darkgrey",11119017).set("darkkhaki",12433259).set("darkmagenta",9109643).set("darkolivegreen",5597999).set("darkorange",16747520).set("darkorchid",10040012).set("darkred",9109504).set("darksalmon",15308410).set("darkseagreen",9419919).set("darkslateblue",4734347).set("darkslategray",3100495).set("darkslategrey",3100495).set("darkturquoise",52945).set("darkviolet",9699539).set("deeppink",16716947).set("deepskyblue",49151).set("dimgray",6908265).set("dimgrey",6908265).set("dodgerblue",2003199).set("firebrick",11674146).set("floralwhite",16775920).set("forestgreen",2263842).set("fuchsia",16711935).set("gainsboro",14474460).set("ghostwhite",16316671).set("gold",16766720).set("goldenrod",14329120).set("gray",8421504).set("green",32768).set("greenyellow",11403055).set("grey",8421504).set("honeydew",15794160).set("hotpink",16738740).set("indianred",13458524).set("indigo",4915330).set("ivory",16777200).set("khaki",15787660).set("lavender",15132410).set("lavenderblush",16773365).set("lawngreen",8190976).set("lemonchiffon",16775885).set("lightblue",11393254).set("lightcoral",15761536).set("lightcyan",14745599).set("lightgoldenrodyellow",16448210).set("lightgray",13882323).set("lightgreen",9498256).set("lightgrey",13882323).set("lightpink",16758465).set("lightsalmon",16752762).set("lightseagreen",2142890).set("lightskyblue",8900346).set("lightslategray",7833753).set("lightslategrey",7833753).set("lightsteelblue",11584734).set("lightyellow",16777184).set("lime",65280).set("limegreen",3329330).set("linen",16445670).set("magenta",16711935).set("maroon",8388608).set("mediumaquamarine",6737322).set("mediumblue",205).set("mediumorchid",12211667).set("mediumpurple",9662683).set("mediumseagreen",3978097).set("mediumslateblue",8087790).set("mediumspringgreen",64154).set("mediumturquoise",4772300).set("mediumvioletred",13047173).set("midnightblue",1644912).set("mintcream",16121850).set("mistyrose",16770273).set("moccasin",16770229).set("navajowhite",16768685).set("navy",128).set("oldlace",16643558).set("olive",8421376).set("olivedrab",7048739).set("orange",16753920).set("orangered",16729344).set("orchid",14315734).set("palegoldenrod",15657130).set("palegreen",10025880).set("paleturquoise",11529966).set("palevioletred",14381203).set("papayawhip",16773077).set("peachpuff",16767673).set("peru",13468991).set("pink",16761035).set("plum",14524637).set("powderblue",11591910).set("purple",8388736).set("rebeccapurple",6697881).set("red",16711680).set("rosybrown",12357519).set("royalblue",4286945).set("saddlebrown",9127187).set("salmon",16416882).set("sandybrown",16032864).set("seagreen",3050327).set("seashell",16774638).set("sienna",10506797).set("silver",12632256).set("skyblue",8900331).set("slateblue",6970061).set("slategray",7372944).set("slategrey",7372944).set("snow",16775930).set("springgreen",65407).set("steelblue",4620980).set("tan",13808780).set("teal",32896).set("thistle",14204888).set("tomato",16737095).set("turquoise",4251856).set("violet",15631086).set("wheat",16113331).set("white",16777215).set("whitesmoke",16119285).set("yellow",16776960).set("yellowgreen",10145074),pe=/^hsl\(\s*([-+]?\d+(?:\.\d+)?)\s*,\s*([-+]?\d+(?:\.\d+)?)%\s*,\s*([-+]?\d+(?:\.\d+)?)%\s*\)$/,de=/^rgb\(\s*([-+]?\d+(?:\.\d+)?)%\s*,\s*([-+]?\d+(?:\.\d+)?)%\s*,\s*([-+]?\d+(?:\.\d+)?)%\s*\)$/,me=/^rgb\(\s*([-+]?\d+)\s*,\s*([-+]?\d+)\s*,\s*([-+]?\d+)\s*\)$/,ve=/^#([0-9a-f]{6})$/,ye=/^#([0-9a-f]{3})$/,_e=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,we=new RegExp(_e.source,"g"),be=[function(t,e){var n,r=typeof e;return("string"===r?(n=rt(e))?(e=n,ut):ct:e instanceof rt?ut:Array.isArray(e)?at:"object"===r&&isNaN(e)?ot:st)(t,e)}],Me=Math.sqrt(2),xe=Math.sqrt(10),ke=Math.sqrt(50),Ne=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"],Ae={"":_t,"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return yt(100*t,e)},r:yt,s:vt,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Se=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;wt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Ee=kt({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),qe=Ee.format,Ce=Ee.formatPrefix,je=Rt(Dt),$e=je.right,ze=$e,Pe=Bt.prototype=new K,Le=18;Pe.brighter=function(t){return new Bt(this.h,this.c,this.l+Le*(null==t?1:t))},Pe.darker=function(t){return new Bt(this.h,this.c,this.l-Le*(null==t?1:t))};var De=Ut.prototype=new K;De.brighter=function(t){return new Ut(this.l+Le*(null==t?1:t),this.a,this.b)},De.darker=function(t){return new Ut(this.l-Le*(null==t?1:t),this.a,this.b)};var Ie=4/29,Re=6/29,Fe=3*Re*Re,Te=1.08883,Oe=.95047,Be=1;De.rgb=function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=Be*Ht(t),e=Oe*Ht(e),n=Te*Ht(n),new Q(Xt(3.2404542*e-1.5371385*t-.4985314*n),Xt(-.969266*e+1.8760108*t+.041556*n),Xt(.0556434*e-.2040259*t+1.0572252*n))};var Ue=Re*Re*Re,Xe=Math.PI/180;Pe.rgb=function(){return Yt(this).rgb()};var He=180/Math.PI,Ve=Jt.prototype=new K;Ve.brighter=function(t){return t=null==t?ce:Math.pow(ce,t),new Jt(this.h,this.s,this.l*t)},Ve.darker=function(t){return t=null==t?he:Math.pow(he,t),new Jt(this.h,this.s,this.l*t)};var Ge=1.97294,Ye=-.90649,Ze=-.29227,Je=1.78277,Ke=-.14861,Qe=1;Ve.rgb=function(){var t=isNaN(this.h)?0:(this.h+120)*Xe,e=Math.pow(this.l,Qe),n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Q(255*(e+n*(Ke*r+Je*i)),255*(e+n*(Ze*r+Ye*i)),255*(e+n*Ge*r))};var We=Ge*Je,tn=Ge*Ye,en=Je*Ze-Ye*Ke;return Qt});